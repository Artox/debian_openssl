diff --git a/ssl/ssl_lib.c b/ssl/ssl_lib.c
index d09bb7d..bc3cbc7 100644
--- a/ssl/ssl_lib.c
+++ b/ssl/ssl_lib.c
@@ -2060,6 +2060,9 @@ SSL_CTX *SSL_CTX_new(const SSL_METHOD *meth)
 	 */
 	ret->options |= SSL_OP_LEGACY_SERVER_CONNECT;
 
+	if (getenv("OPENSSL_ALLOW_SSLv3") == NULL)
+		ret->options |= SSL_OP_NO_SSLv3;
+
 	return(ret);
 err:
 	SSLerr(SSL_F_SSL_CTX_NEW,ERR_R_MALLOC_FAILURE);
