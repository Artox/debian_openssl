From ffd14272c4c82f68a07b2e2192538adb560fa684 Mon Sep 17 00:00:00 2001
From: "Dr. Stephen Henson" <steve@openssl.org>
Date: Wed, 7 Jan 2015 17:36:17 +0000
Subject: [PATCH 107/117] fix error discrepancy

Reviewed-by: Matt Caswell <matt@openssl.org>
(cherry picked from commit 4a4d4158572fd8b3dc641851b8378e791df7972d)
---
 ssl/s3_clnt.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/ssl/s3_clnt.c b/ssl/s3_clnt.c
index 023c679..7692716 100644
--- a/ssl/s3_clnt.c
+++ b/ssl/s3_clnt.c
@@ -1541,7 +1541,7 @@ int ssl3_get_key_exchange(SSL *s)
 		if (!SSL_C_IS_EXPORT(s->s3->tmp.new_cipher))
 			{
 			al=SSL_AD_UNEXPECTED_MESSAGE;
-			SSLerr(SSL_F_SSL3_GET_SERVER_CERTIFICATE,SSL_R_UNEXPECTED_MESSAGE);
+			SSLerr(SSL_F_SSL3_GET_KEY_EXCHANGE,SSL_R_UNEXPECTED_MESSAGE);
 			goto f_err;
 			}
 		if ((rsa=RSA_new()) == NULL)
-- 
2.1.4

